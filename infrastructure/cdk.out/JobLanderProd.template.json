{
 "Resources": {
  "UploadsBucket5E5E9B64": {
   "Type": "AWS::S3::Bucket",
   "Properties": {
    "BucketEncryption": {
     "ServerSideEncryptionConfiguration": [
      {
       "ServerSideEncryptionByDefault": {
        "SSEAlgorithm": "AES256"
       }
      }
     ]
    },
    "BucketName": "job-lander-uploads-production-817977749885",
    "CorsConfiguration": {
     "CorsRules": [
      {
       "AllowedHeaders": [
        "*"
       ],
       "AllowedMethods": [
        "GET",
        "PUT",
        "POST",
        "DELETE"
       ],
       "AllowedOrigins": [
        "*"
       ]
      }
     ]
    },
    "LifecycleConfiguration": {
     "Rules": [
      {
       "ExpirationInDays": 90,
       "Id": "ExpireOldUploads",
       "Status": "Enabled"
      }
     ]
    },
    "VersioningConfiguration": {
     "Status": "Enabled"
    }
   },
   "UpdateReplacePolicy": "Retain",
   "DeletionPolicy": "Retain",
   "Metadata": {
    "aws:cdk:path": "JobLanderProd/UploadsBucket/Resource"
   }
  },
  "UploadsBucketPolicy34A32B0B": {
   "Type": "AWS::S3::BucketPolicy",
   "Properties": {
    "Bucket": {
     "Ref": "UploadsBucket5E5E9B64"
    },
    "PolicyDocument": {
     "Statement": [
      {
       "Action": "s3:GetObject",
       "Effect": "Allow",
       "Principal": {
        "CanonicalUser": {
         "Fn::GetAtt": [
          "DistributionOrigin2S3OriginE484D4BF",
          "S3CanonicalUserId"
         ]
        }
       },
       "Resource": {
        "Fn::Join": [
         "",
         [
          {
           "Fn::GetAtt": [
            "UploadsBucket5E5E9B64",
            "Arn"
           ]
          },
          "/*"
         ]
        ]
       }
      }
     ],
     "Version": "2012-10-17"
    }
   },
   "Metadata": {
    "aws:cdk:path": "JobLanderProd/UploadsBucket/Policy/Resource"
   }
  },
  "DBSecretD58955BC": {
   "Type": "AWS::SecretsManager::Secret",
   "Properties": {
    "GenerateSecretString": {
     "ExcludePunctuation": true,
     "GenerateStringKey": "password",
     "IncludeSpace": false,
     "SecretStringTemplate": "{\"username\":\"postgres\"}"
    },
    "Name": "job-lander-db-secret-production"
   },
   "UpdateReplacePolicy": "Delete",
   "DeletionPolicy": "Delete",
   "Metadata": {
    "aws:cdk:path": "JobLanderProd/DBSecret/Resource"
   }
  },
  "DBSecretAttachmentC565A14F": {
   "Type": "AWS::SecretsManager::SecretTargetAttachment",
   "Properties": {
    "SecretId": {
     "Ref": "DBSecretD58955BC"
    },
    "TargetId": {
     "Ref": "DatabaseB269D8BB"
    },
    "TargetType": "AWS::RDS::DBInstance"
   },
   "Metadata": {
    "aws:cdk:path": "JobLanderProd/DBSecret/Attachment/Resource"
   }
  },
  "DBSecurityGroupE3B245A3": {
   "Type": "AWS::EC2::SecurityGroup",
   "Properties": {
    "GroupDescription": "Security group for Job-Lander RDS instance",
    "SecurityGroupEgress": [
     {
      "CidrIp": "0.0.0.0/0",
      "Description": "Allow all outbound traffic by default",
      "IpProtocol": "-1"
     }
    ],
    "SecurityGroupIngress": [
     {
      "Description": "Allow ECS tasks to access RDS",
      "FromPort": 5432,
      "IpProtocol": "tcp",
      "SourceSecurityGroupId": {
       "Fn::GetAtt": [
        "ECSSecurityGroupA14DBE7D",
        "GroupId"
       ]
      },
      "ToPort": 5432
     }
    ],
    "VpcId": "vpc-03019039f5b20e40d"
   },
   "Metadata": {
    "aws:cdk:path": "JobLanderProd/DBSecurityGroup/Resource"
   }
  },
  "DatabaseSubnetGroup7D60F180": {
   "Type": "AWS::RDS::DBSubnetGroup",
   "Properties": {
    "DBSubnetGroupDescription": "Subnet group for Database database",
    "SubnetIds": [
     "subnet-0aff1eabf6f102b31",
     "subnet-0b412834e2219fc84",
     "subnet-0c55b0d57fbee267b",
     "subnet-0ff4ce7df07628b4f",
     "subnet-0c3b2320510446ec3",
     "subnet-0859081978043eb6a"
    ]
   },
   "Metadata": {
    "aws:cdk:path": "JobLanderProd/Database/SubnetGroup/Default"
   }
  },
  "DatabaseB269D8BB": {
   "Type": "AWS::RDS::DBInstance",
   "Properties": {
    "AllocatedStorage": "100",
    "BackupRetentionPeriod": 7,
    "CopyTagsToSnapshot": true,
    "DBInstanceClass": "db.t3.medium",
    "DBName": "joblander",
    "DBSubnetGroupName": {
     "Ref": "DatabaseSubnetGroup7D60F180"
    },
    "DeleteAutomatedBackups": false,
    "EnablePerformanceInsights": true,
    "Engine": "postgres",
    "EngineVersion": "15.8",
    "MasterUserPassword": {
     "Fn::Join": [
      "",
      [
       "{{resolve:secretsmanager:",
       {
        "Ref": "DBSecretD58955BC"
       },
       ":SecretString:password::}}"
      ]
     ]
    },
    "MasterUsername": {
     "Fn::Join": [
      "",
      [
       "{{resolve:secretsmanager:",
       {
        "Ref": "DBSecretD58955BC"
       },
       ":SecretString:username::}}"
      ]
     ]
    },
    "MaxAllocatedStorage": 500,
    "PerformanceInsightsRetentionPeriod": 7,
    "PubliclyAccessible": false,
    "StorageType": "gp3",
    "VPCSecurityGroups": [
     {
      "Fn::GetAtt": [
       "DBSecurityGroupE3B245A3",
       "GroupId"
      ]
     }
    ]
   },
   "UpdateReplacePolicy": "Snapshot",
   "DeletionPolicy": "Snapshot",
   "Metadata": {
    "aws:cdk:path": "JobLanderProd/Database/Resource"
   }
  },
  "JobLanderCluster9A38F0EB": {
   "Type": "AWS::ECS::Cluster",
   "Properties": {
    "ClusterName": "JobLanderProd-JobLanderCluster",
    "ClusterSettings": [
     {
      "Name": "containerInsights",
      "Value": "enabled"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "JobLanderProd/JobLanderCluster/Resource"
   }
  },
  "ALBAEE750D2": {
   "Type": "AWS::ElasticLoadBalancingV2::LoadBalancer",
   "Properties": {
    "LoadBalancerAttributes": [
     {
      "Key": "deletion_protection.enabled",
      "Value": "false"
     }
    ],
    "Name": "JobLanderProd-ALB",
    "Scheme": "internet-facing",
    "SecurityGroups": [
     {
      "Fn::GetAtt": [
       "ALBSecurityGroup8B8624F8",
       "GroupId"
      ]
     }
    ],
    "Subnets": [
     "subnet-0aff1eabf6f102b31",
     "subnet-0b412834e2219fc84",
     "subnet-0c55b0d57fbee267b",
     "subnet-0ff4ce7df07628b4f",
     "subnet-0c3b2320510446ec3",
     "subnet-0859081978043eb6a"
    ],
    "Type": "application"
   },
   "Metadata": {
    "aws:cdk:path": "JobLanderProd/ALB/Resource"
   }
  },
  "ALBSecurityGroup8B8624F8": {
   "Type": "AWS::EC2::SecurityGroup",
   "Properties": {
    "GroupDescription": "Automatically created Security Group for ELB JobLanderProdALB0A913128",
    "SecurityGroupIngress": [
     {
      "CidrIp": "0.0.0.0/0",
      "Description": "Allow from anyone on port 80",
      "FromPort": 80,
      "IpProtocol": "tcp",
      "ToPort": 80
     }
    ],
    "VpcId": "vpc-03019039f5b20e40d"
   },
   "Metadata": {
    "aws:cdk:path": "JobLanderProd/ALB/SecurityGroup/Resource"
   }
  },
  "ALBSecurityGrouptoJobLanderProdECSSecurityGroup36DA0B265000F3ADCC75": {
   "Type": "AWS::EC2::SecurityGroupEgress",
   "Properties": {
    "Description": "Load balancer to target",
    "DestinationSecurityGroupId": {
     "Fn::GetAtt": [
      "ECSSecurityGroupA14DBE7D",
      "GroupId"
     ]
    },
    "FromPort": 5000,
    "GroupId": {
     "Fn::GetAtt": [
      "ALBSecurityGroup8B8624F8",
      "GroupId"
     ]
    },
    "IpProtocol": "tcp",
    "ToPort": 5000
   },
   "Metadata": {
    "aws:cdk:path": "JobLanderProd/ALB/SecurityGroup/to JobLanderProdECSSecurityGroup36DA0B26:5000"
   }
  },
  "ALBListener3B99FF85": {
   "Type": "AWS::ElasticLoadBalancingV2::Listener",
   "Properties": {
    "DefaultActions": [
     {
      "TargetGroupArn": {
       "Ref": "TargetGroup3D7CD9B8"
      },
      "Type": "forward"
     }
    ],
    "LoadBalancerArn": {
     "Ref": "ALBAEE750D2"
    },
    "Port": 80,
    "Protocol": "HTTP"
   },
   "Metadata": {
    "aws:cdk:path": "JobLanderProd/ALB/Listener/Resource"
   }
  },
  "LogGroupF5B46931": {
   "Type": "AWS::Logs::LogGroup",
   "Properties": {
    "LogGroupName": "/ecs/job-lander-production",
    "RetentionInDays": 30
   },
   "UpdateReplacePolicy": "Retain",
   "DeletionPolicy": "Retain",
   "Metadata": {
    "aws:cdk:path": "JobLanderProd/LogGroup/Resource"
   }
  },
  "TaskDefTaskRole1EDB4A67": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "ecs-tasks.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    }
   },
   "Metadata": {
    "aws:cdk:path": "JobLanderProd/TaskDef/TaskRole/Resource"
   }
  },
  "TaskDefTaskRoleDefaultPolicyA592CB18": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "s3:Abort*",
        "s3:DeleteObject*",
        "s3:GetBucket*",
        "s3:GetObject*",
        "s3:List*",
        "s3:PutObject",
        "s3:PutObjectLegalHold",
        "s3:PutObjectRetention",
        "s3:PutObjectTagging",
        "s3:PutObjectVersionTagging"
       ],
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::GetAtt": [
          "UploadsBucket5E5E9B64",
          "Arn"
         ]
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::GetAtt": [
             "UploadsBucket5E5E9B64",
             "Arn"
            ]
           },
           "/*"
          ]
         ]
        }
       ]
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "TaskDefTaskRoleDefaultPolicyA592CB18",
    "Roles": [
     {
      "Ref": "TaskDefTaskRole1EDB4A67"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "JobLanderProd/TaskDef/TaskRole/DefaultPolicy/Resource"
   }
  },
  "TaskDef54694570": {
   "Type": "AWS::ECS::TaskDefinition",
   "Properties": {
    "ContainerDefinitions": [
     {
      "Environment": [
       {
        "Name": "NODE_ENV",
        "Value": "production"
       },
       {
        "Name": "PORT",
        "Value": "5000"
       },
       {
        "Name": "AWS_REGION",
        "Value": "us-east-1"
       },
       {
        "Name": "S3_BUCKET_NAME",
        "Value": {
         "Ref": "UploadsBucket5E5E9B64"
        }
       },
       {
        "Name": "DB_HOST",
        "Value": {
         "Fn::GetAtt": [
          "DatabaseB269D8BB",
          "Endpoint.Address"
         ]
        }
       },
       {
        "Name": "DB_PORT",
        "Value": {
         "Fn::GetAtt": [
          "DatabaseB269D8BB",
          "Endpoint.Port"
         ]
        }
       },
       {
        "Name": "DB_NAME",
        "Value": "joblander"
       },
       {
        "Name": "DB_USER",
        "Value": "postgres"
       }
      ],
      "Essential": true,
      "HealthCheck": {
       "Command": [
        "CMD-SHELL",
        "curl -f http://localhost:5000/api/health || exit 1"
       ],
       "Interval": 30,
       "Retries": 3,
       "StartPeriod": 60,
       "Timeout": 5
      },
      "Image": {
       "Fn::Join": [
        "",
        [
         "817977749885.dkr.ecr.us-east-1.",
         {
          "Ref": "AWS::URLSuffix"
         },
         "/job-lander-production:latest"
        ]
       ]
      },
      "LogConfiguration": {
       "LogDriver": "awslogs",
       "Options": {
        "awslogs-group": {
         "Ref": "LogGroupF5B46931"
        },
        "awslogs-stream-prefix": "ecs",
        "awslogs-region": "us-east-1"
       }
      },
      "Name": "JobLanderContainer",
      "PortMappings": [
       {
        "ContainerPort": 5000,
        "Protocol": "tcp"
       }
      ],
      "Secrets": [
       {
        "Name": "DB_PASSWORD",
        "ValueFrom": {
         "Fn::Join": [
          "",
          [
           {
            "Ref": "DBSecretD58955BC"
           },
           ":password::"
          ]
         ]
        }
       },
       {
        "Name": "GEMINI_API_KEY",
        "ValueFrom": "arn:aws:secretsmanager:us-east-1:817977749885:secret:job-lander/gemini-api-key-production"
       },
       {
        "Name": "SESSION_SECRET",
        "ValueFrom": "arn:aws:secretsmanager:us-east-1:817977749885:secret:job-lander/session-secret-production"
       },
       {
        "Name": "CANVA_CLIENT_ID",
       },
       {
        "Name": "CANVA_CLIENT_SECRET",
       },
       {
        "Name": "JSEARCH_API_KEY",
        "ValueFrom": "arn:aws:secretsmanager:us-east-1:817977749885:secret:job-lander/jsearch-api-key-production"
       },
       {
        "Name": "WEB3_RPC_URL",
        "ValueFrom": "arn:aws:secretsmanager:us-east-1:817977749885:secret:job-lander/web3-rpc-url-production"
       },
       {
        "Name": "PRIVATE_KEY",
        "ValueFrom": "arn:aws:secretsmanager:us-east-1:817977749885:secret:job-lander/private-key-production"
       }
      ]
     }
    ],
    "Cpu": "2048",
    "ExecutionRoleArn": {
     "Fn::GetAtt": [
      "TaskDefExecutionRoleB4775C97",
      "Arn"
     ]
    },
    "Family": "job-lander-task-production",
    "Memory": "4096",
    "NetworkMode": "awsvpc",
    "RequiresCompatibilities": [
     "FARGATE"
    ],
    "TaskRoleArn": {
     "Fn::GetAtt": [
      "TaskDefTaskRole1EDB4A67",
      "Arn"
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "JobLanderProd/TaskDef/Resource"
   }
  },
  "TaskDefExecutionRoleB4775C97": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "ecs-tasks.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    }
   },
   "Metadata": {
    "aws:cdk:path": "JobLanderProd/TaskDef/ExecutionRole/Resource"
   }
  },
  "TaskDefExecutionRoleDefaultPolicy0DBB737A": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "ecr:BatchCheckLayerAvailability",
        "ecr:BatchGetImage",
        "ecr:GetDownloadUrlForLayer"
       ],
       "Effect": "Allow",
       "Resource": "arn:aws:ecr:us-east-1:817977749885:repository/job-lander-production"
      },
      {
       "Action": "ecr:GetAuthorizationToken",
       "Effect": "Allow",
       "Resource": "*"
      },
      {
       "Action": [
        "logs:CreateLogStream",
        "logs:PutLogEvents"
       ],
       "Effect": "Allow",
       "Resource": {
        "Fn::GetAtt": [
         "LogGroupF5B46931",
         "Arn"
        ]
       }
      },
      {
       "Action": [
        "secretsmanager:DescribeSecret",
        "secretsmanager:GetSecretValue"
       ],
       "Effect": "Allow",
       "Resource": [
        "arn:aws:secretsmanager:us-east-1:817977749885:secret:job-lander/gemini-api-key-production-??????",
        "arn:aws:secretsmanager:us-east-1:817977749885:secret:job-lander/jsearch-api-key-production-??????",
        "arn:aws:secretsmanager:us-east-1:817977749885:secret:job-lander/private-key-production-??????",
        "arn:aws:secretsmanager:us-east-1:817977749885:secret:job-lander/session-secret-production-??????",
        "arn:aws:secretsmanager:us-east-1:817977749885:secret:job-lander/web3-rpc-url-production-??????",
        {
         "Ref": "DBSecretD58955BC"
        }
       ]
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "TaskDefExecutionRoleDefaultPolicy0DBB737A",
    "Roles": [
     {
      "Ref": "TaskDefExecutionRoleB4775C97"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "JobLanderProd/TaskDef/ExecutionRole/DefaultPolicy/Resource"
   }
  },
  "ECSSecurityGroupA14DBE7D": {
   "Type": "AWS::EC2::SecurityGroup",
   "Properties": {
    "GroupDescription": "Security group for Job-Lander ECS service",
    "SecurityGroupEgress": [
     {
      "CidrIp": "0.0.0.0/0",
      "Description": "Allow all outbound traffic by default",
      "IpProtocol": "-1"
     }
    ],
    "SecurityGroupIngress": [
     {
      "Description": "Allow ALB to access ECS service",
      "FromPort": 5000,
      "IpProtocol": "tcp",
      "SourceSecurityGroupId": {
       "Fn::GetAtt": [
        "ALBSecurityGroup8B8624F8",
        "GroupId"
       ]
      },
      "ToPort": 5000
     }
    ],
    "VpcId": "vpc-03019039f5b20e40d"
   },
   "Metadata": {
    "aws:cdk:path": "JobLanderProd/ECSSecurityGroup/Resource"
   }
  },
  "ECSSecurityGroupfromJobLanderProdALBSecurityGroupBAA2A47D50000D70E0A0": {
   "Type": "AWS::EC2::SecurityGroupIngress",
   "Properties": {
    "Description": "Load balancer to target",
    "FromPort": 5000,
    "GroupId": {
     "Fn::GetAtt": [
      "ECSSecurityGroupA14DBE7D",
      "GroupId"
     ]
    },
    "IpProtocol": "tcp",
    "SourceSecurityGroupId": {
     "Fn::GetAtt": [
      "ALBSecurityGroup8B8624F8",
      "GroupId"
     ]
    },
    "ToPort": 5000
   },
   "Metadata": {
    "aws:cdk:path": "JobLanderProd/ECSSecurityGroup/from JobLanderProdALBSecurityGroupBAA2A47D:5000"
   }
  },
  "ServiceD69D759B": {
   "Type": "AWS::ECS::Service",
   "Properties": {
    "Cluster": {
     "Ref": "JobLanderCluster9A38F0EB"
    },
    "DeploymentConfiguration": {
     "DeploymentCircuitBreaker": {
      "Enable": true,
      "Rollback": true
     },
     "MaximumPercent": 200,
     "MinimumHealthyPercent": 50
    },
    "DesiredCount": 3,
    "EnableECSManagedTags": false,
    "HealthCheckGracePeriodSeconds": 60,
    "LaunchType": "FARGATE",
    "LoadBalancers": [
     {
      "ContainerName": "JobLanderContainer",
      "ContainerPort": 5000,
      "TargetGroupArn": {
       "Ref": "TargetGroup3D7CD9B8"
      }
     }
    ],
    "NetworkConfiguration": {
     "AwsvpcConfiguration": {
      "AssignPublicIp": "ENABLED",
      "SecurityGroups": [
       {
        "Fn::GetAtt": [
         "ECSSecurityGroupA14DBE7D",
         "GroupId"
        ]
       }
      ],
      "Subnets": [
       "subnet-0aff1eabf6f102b31",
       "subnet-0b412834e2219fc84",
       "subnet-0c55b0d57fbee267b",
       "subnet-0ff4ce7df07628b4f",
       "subnet-0c3b2320510446ec3",
       "subnet-0859081978043eb6a"
      ]
     }
    },
    "ServiceName": "JobLanderProd-JobLanderService",
    "TaskDefinition": {
     "Ref": "TaskDef54694570"
    }
   },
   "DependsOn": [
    "ALBListener3B99FF85",
    "TaskDefTaskRoleDefaultPolicyA592CB18",
    "TaskDefTaskRole1EDB4A67"
   ],
   "Metadata": {
    "aws:cdk:path": "JobLanderProd/Service/Service"
   }
  },
  "ServiceTaskCountTarget23E25614": {
   "Type": "AWS::ApplicationAutoScaling::ScalableTarget",
   "Properties": {
    "MaxCapacity": 9,
    "MinCapacity": 3,
    "ResourceId": {
     "Fn::Join": [
      "",
      [
       "service/",
       {
        "Ref": "JobLanderCluster9A38F0EB"
       },
       "/",
       {
        "Fn::GetAtt": [
         "ServiceD69D759B",
         "Name"
        ]
       }
      ]
     ]
    },
    "RoleARN": "arn:aws:iam::817977749885:role/aws-service-role/ecs.application-autoscaling.amazonaws.com/AWSServiceRoleForApplicationAutoScaling_ECSService",
    "ScalableDimension": "ecs:service:DesiredCount",
    "ServiceNamespace": "ecs"
   },
   "DependsOn": [
    "TaskDefTaskRoleDefaultPolicyA592CB18",
    "TaskDefTaskRole1EDB4A67"
   ],
   "Metadata": {
    "aws:cdk:path": "JobLanderProd/Service/TaskCount/Target/Resource"
   }
  },
  "ServiceTaskCountTargetCpuScalingCC8A5DF6": {
   "Type": "AWS::ApplicationAutoScaling::ScalingPolicy",
   "Properties": {
    "PolicyName": "JobLanderProdServiceTaskCountTargetCpuScalingF1D11F33",
    "PolicyType": "TargetTrackingScaling",
    "ScalingTargetId": {
     "Ref": "ServiceTaskCountTarget23E25614"
    },
    "TargetTrackingScalingPolicyConfiguration": {
     "PredefinedMetricSpecification": {
      "PredefinedMetricType": "ECSServiceAverageCPUUtilization"
     },
     "ScaleInCooldown": 60,
     "ScaleOutCooldown": 60,
     "TargetValue": 70
    }
   },
   "DependsOn": [
    "TaskDefTaskRoleDefaultPolicyA592CB18",
    "TaskDefTaskRole1EDB4A67"
   ],
   "Metadata": {
    "aws:cdk:path": "JobLanderProd/Service/TaskCount/Target/CpuScaling/Resource"
   }
  },
  "ServiceTaskCountTargetMemoryScalingEA4B07C8": {
   "Type": "AWS::ApplicationAutoScaling::ScalingPolicy",
   "Properties": {
    "PolicyName": "JobLanderProdServiceTaskCountTargetMemoryScalingCCA50323",
    "PolicyType": "TargetTrackingScaling",
    "ScalingTargetId": {
     "Ref": "ServiceTaskCountTarget23E25614"
    },
    "TargetTrackingScalingPolicyConfiguration": {
     "PredefinedMetricSpecification": {
      "PredefinedMetricType": "ECSServiceAverageMemoryUtilization"
     },
     "ScaleInCooldown": 60,
     "ScaleOutCooldown": 60,
     "TargetValue": 80
    }
   },
   "DependsOn": [
    "TaskDefTaskRoleDefaultPolicyA592CB18",
    "TaskDefTaskRole1EDB4A67"
   ],
   "Metadata": {
    "aws:cdk:path": "JobLanderProd/Service/TaskCount/Target/MemoryScaling/Resource"
   }
  },
  "TargetGroup3D7CD9B8": {
   "Type": "AWS::ElasticLoadBalancingV2::TargetGroup",
   "Properties": {
    "HealthCheckIntervalSeconds": 30,
    "HealthCheckPath": "/api/health",
    "HealthCheckTimeoutSeconds": 5,
    "HealthyThresholdCount": 2,
    "Port": 5000,
    "Protocol": "HTTP",
    "TargetGroupAttributes": [
     {
      "Key": "deregistration_delay.timeout_seconds",
      "Value": "30"
     },
     {
      "Key": "stickiness.enabled",
      "Value": "false"
     }
    ],
    "TargetType": "ip",
    "UnhealthyThresholdCount": 3,
    "VpcId": "vpc-03019039f5b20e40d"
   },
   "Metadata": {
    "aws:cdk:path": "JobLanderProd/TargetGroup/Resource"
   }
  },
  "DistributionOrigin2S3OriginE484D4BF": {
   "Type": "AWS::CloudFront::CloudFrontOriginAccessIdentity",
   "Properties": {
    "CloudFrontOriginAccessIdentityConfig": {
     "Comment": "Identity for JobLanderProdDistributionOrigin2E1613438"
    }
   },
   "Metadata": {
    "aws:cdk:path": "JobLanderProd/Distribution/Origin2/S3Origin/Resource"
   }
  },
  "Distribution830FAC52": {
   "Type": "AWS::CloudFront::Distribution",
   "Properties": {
    "DistributionConfig": {
     "CacheBehaviors": [
      {
       "CachePolicyId": "658327ea-f89d-4fab-a63d-7e88639e58f6",
       "Compress": true,
       "PathPattern": "/assets/*",
       "TargetOriginId": "JobLanderProdDistributionOrigin2E1613438",
       "ViewerProtocolPolicy": "redirect-to-https"
      }
     ],
     "DefaultCacheBehavior": {
      "AllowedMethods": [
       "GET",
       "HEAD",
       "OPTIONS",
       "PUT",
       "PATCH",
       "POST",
       "DELETE"
      ],
      "CachePolicyId": "4135ea2d-6df8-44a3-9df3-4b5a84be39ad",
      "Compress": true,
      "OriginRequestPolicyId": "216adef6-5c7f-47e4-b989-5492eafa07d3",
      "TargetOriginId": "JobLanderProdDistributionOrigin1593BAE88",
      "ViewerProtocolPolicy": "redirect-to-https"
     },
     "Enabled": true,
     "HttpVersion": "http2",
     "IPV6Enabled": true,
     "Origins": [
      {
       "CustomOriginConfig": {
        "OriginProtocolPolicy": "http-only",
        "OriginSSLProtocols": [
         "TLSv1.2"
        ]
       },
       "DomainName": {
        "Fn::GetAtt": [
         "ALBAEE750D2",
         "DNSName"
        ]
       },
       "Id": "JobLanderProdDistributionOrigin1593BAE88"
      },
      {
       "DomainName": {
        "Fn::GetAtt": [
         "UploadsBucket5E5E9B64",
         "RegionalDomainName"
        ]
       },
       "Id": "JobLanderProdDistributionOrigin2E1613438",
       "S3OriginConfig": {
        "OriginAccessIdentity": {
         "Fn::Join": [
          "",
          [
           "origin-access-identity/cloudfront/",
           {
            "Ref": "DistributionOrigin2S3OriginE484D4BF"
           }
          ]
         ]
        }
       }
      }
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "JobLanderProd/Distribution/Resource"
   }
  },
  "CDKMetadata": {
   "Type": "AWS::CDK::Metadata",
   "Properties": {
    "Analytics": "v2:deflate64:H4sIAAAAAAAA/31TyW7jMAz9lrkrapvppccs00GAAi3i3Ae0zHjYKJKhJUVg+N9LS3bitJg5kXp8fBIXzeX84Une/4APP1PVYaaplG0RQB3EFr2NTqHg2J/W/5TtMqoDBrHam8HL5s1qUucrnM+d8KgcBn8EAzU6lk3nnjd42ezA1RgWgS/9e0QzIXyNdALVPOlER+H829nYDOz/AL9qh95/gzcm4Z1wlZftGgKU4HFjfADDRRexNBguiuvlN2Ck9q9ycouN9RSsOy9ZhiEWXenoA7qePrrPXBIE3IE/rHFPhgJZ0xO+ItYEIINugg25BboT8QtTQdktFGgodZJd2Zg6pcEHUtpCVXLQKDL1iZu3aBqeDvSCLxxbplh+4815yiN+uhk4oz+J5zFdOjM5dkLbmhvxYutLePQ7QXCU7dbqVEqy100adwiu10AM1nOhXAjvwKXi/rLUi1skm53jTeaEIudd9W+ATnCfYrV33HReBS7RURlTz18d1WQWSvGqbCreQV6fPE9OeO4T/sWYynRdj7zG0EQejbEVynd/d5o/yod7/nzvnmjmeGx0RLnN9hNRT3/gmQMAAA=="
   },
   "Metadata": {
    "aws:cdk:path": "JobLanderProd/CDKMetadata/Default"
   }
  }
 },
 "Outputs": {
  "LoadBalancerDNS": {
   "Description": "Application Load Balancer DNS",
   "Value": {
    "Fn::GetAtt": [
     "ALBAEE750D2",
     "DNSName"
    ]
   }
  },
  "CloudFrontURL": {
   "Description": "CloudFront Distribution URL",
   "Value": {
    "Fn::Join": [
     "",
     [
      "https://",
      {
       "Fn::GetAtt": [
        "Distribution830FAC52",
        "DomainName"
       ]
      }
     ]
    ]
   }
  },
  "DatabaseEndpoint": {
   "Description": "RDS Database Endpoint",
   "Value": {
    "Fn::GetAtt": [
     "DatabaseB269D8BB",
     "Endpoint.Address"
    ]
   }
  },
  "ECRRepositoryURI": {
   "Description": "ECR Repository URI",
   "Value": {
    "Fn::Join": [
     "",
     [
      "817977749885.dkr.ecr.us-east-1.",
      {
       "Ref": "AWS::URLSuffix"
      },
      "/job-lander-production"
     ]
    ]
   }
  },
  "UploadsBucketName": {
   "Description": "S3 Uploads Bucket Name",
   "Value": {
    "Ref": "UploadsBucket5E5E9B64"
   }
  },
  "ClusterName": {
   "Description": "ECS Cluster Name",
   "Value": {
    "Ref": "JobLanderCluster9A38F0EB"
   }
  },
  "ServiceName": {
   "Description": "ECS Service Name",
   "Value": {
    "Fn::GetAtt": [
     "ServiceD69D759B",
     "Name"
    ]
   }
  }
 },
 "Parameters": {
  "BootstrapVersion": {
   "Type": "AWS::SSM::Parameter::Value<String>",
   "Default": "/cdk-bootstrap/hnb659fds/version",
   "Description": "Version of the CDK Bootstrap resources in this environment, automatically retrieved from SSM Parameter Store. [cdk:skip]"
  }
 },
 "Rules": {
  "CheckBootstrapVersion": {
   "Assertions": [
    {
     "Assert": {
      "Fn::Not": [
       {
        "Fn::Contains": [
         [
          "1",
          "2",
          "3",
          "4",
          "5"
         ],
         {
          "Ref": "BootstrapVersion"
         }
        ]
       }
      ]
     },
     "AssertDescription": "CDK bootstrap stack version 6 required. Please run 'cdk bootstrap' with a recent version of the CDK CLI."
    }
   ]
  }
 }
}